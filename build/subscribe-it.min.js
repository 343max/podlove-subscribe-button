var IframeResizer,SubscribeButton,SubscribeIt,SubscribePopup,SubscribePopupIframe,__hasProp={}.hasOwnProperty;IframeResizer=function(){function t(t,e,n,i){null==n&&(n={}),window.addEventListener("message",function(){return function(s){var a,r,o;return r=JSON.parse(s.data),r.id===e.id&&r.listenTo===t?(a=r.height+(n.height||0),o=r.width+(n.width||0),e.style.height=""+a+"px",e.style.width=""+o+"px",null!=i?i(e):void 0):void 0}}(this),!1)}return t.buildData=function(t,e,n,i){return'{"id": "'+i+'", "listenTo": "'+t+'", "height": '+e+', "width": '+n+"}"},t}(),SubscribeIt=function(){function t(t){this.scriptElem=t,this.extractScriptPath(),this.extractFeedUrl(),this.extractButtonLanguage(),this.extractButtonSize(),this.extractPodcastData(),this.renderIframe()}return t.init=function(e){var n,i,s,a,r;for(null==e&&(e="subscribe-it"),i=document.getElementsByName(e),r=[],s=0,a=i.length;a>s;s++)n=i[s],r.push(new t(n));return r},t.prototype.extractScriptPath=function(){return this.pathPrefix=this.scriptElem.src.match(/(^.*\/)/)[0]},t.prototype.extractFeedUrl=function(){return this.feedUrl=this.scriptElem.dataset.url},t.prototype.extractButtonLanguage=function(){return this.buttonLanguage=this.scriptElem.dataset.language||"en"},t.prototype.extractButtonSize=function(){return this.buttonSize=this.scriptElem.dataset.size||"medium"},t.prototype.extractPodcastData=function(){var t;return(t=this.scriptElem.dataset.podcast)?this.podcast=JSON.parse(t.replace(/'/g,'"')):void 0},t.prototype.buttonParams=function(){return{size:this.buttonSize,language:this.buttonLanguage}},t.prototype.renderIframe=function(){var t;return t=this.buildIframe(),this.scriptElem.parentElement.replaceChild(t,this.scriptElem)},t.prototype.buildIframe=function(){var t,e;return t=Math.floor(65536*(1+Math.random())).toString(16).substring(1),e=document.createElement("iframe"),e.src=""+this.pathPrefix+"button.html?language="+this.buttonLanguage+"&size="+this.buttonSize+"&id="+t,e.style.border="none",e.style.display="block",e.style.overflow="hidden",e.className="podlove-subscribe-button",e.id=t,e.onload=function(t){return function(){return e.contentDocument.addEventListener("click",function(){return new SubscribePopupIframe(e,t.feedUrl,t.pathPrefix,t.podcast,t.buttonLanguage)})}}(this),new IframeResizer("resizeButton",e),e},t}(),new SubscribeIt.init,SubscribePopupIframe=function(){function t(t,e,n,i,s){this.buttonIframe=t,this.feedUrl=e,this.pathPrefix=n,this.podcast=i,this.language=s,this.insert(),this.addCloseListener()}return t.prototype.build=function(){var t;return t=document.createElement("iframe"),t.className="subscribe-it-popup-iframe",t.src=""+this.pathPrefix+"popup.html?feedUrl="+this.feedUrl+"&language="+this.language+this.podcastInfo(),t.style.border="none",t.style.position="absolute",t.style.height="100vh",t.style.width="100vw",t.style.top=0,t.style.left=0,this.iframe=t},t.prototype.podcastInfo=function(){var t;return t="",this.podcast?(this.podcast.name&&(t+="&podcastName="+this.podcast.name),this.podcast.coverUrl&&(t+="&podcastCoverUrl="+this.podcast.coverUrl),this.podcast.subtitle?t+="&podcastSubtitle="+this.podcast.subtitle:void 0):t},t.prototype.insert=function(){return document.body.appendChild(this.build())},t.prototype.remove=function(){return this.iframe.parentNode.removeChild(this.iframe)},t.prototype.addCloseListener=function(){var t,e;return document.body.addEventListener("click",function(){return document.body.dispatchEvent(new Event("click.subscribe-it"))}),t=function(t){return"closepopup"===JSON.parse(t.data).message?e():void 0},window.addEventListener("message",t,!1),document.body.addEventListener("click.subscribe-it",e),e=function(n){return function(){return n.remove(),document.body.removeEventListener("click.subscribe-it",e),window.removeEventListener("message",t,!1)}}(this)},t.prototype.buttonDimensions=function(){return null!=this.buttonRect?this.buttonRect:this.buttonRect=this.buttonIframe.getBoundingClientRect()},t}(),SubscribePopup=function(){function t(){var t;this.extractParams(),this.body=document.getElementById("subscribe-it-popup"),this.modal=document.getElementById("subscribe-it-popup-modal"),this.closeButton=document.getElementById("subscribe-it-popup-close-button"),this.leftSide=document.getElementById("subscribe-it-popup-modal-left"),this.middle=document.getElementById("subscribe-it-popup-modal-middle"),this.rightSide=document.getElementById("subscribe-it-popup-modal-right"),this.list=document.getElementById("subscribe-it-list"),this.helptext=document.getElementById("subscribe-it-popup-modal-helptext"),t=window.location,this.pathPrefix=t.href.replace(t.search,"").match(/(^.*\/)/)[0],this.addCloseHandler(),this.addList(),this.addOtherClientButton(),this.addPodcastInfo(),this.adjustHeight()}return t.prototype.addDoneButton=function(){var t;return t=document.createElement("a"),t.className="subscribe-it-install-button subscribe-it-done-button",t.href="#",t.addEventListener("click",function(){return window.parent.postMessage('{"message": "closepopup"}',"*")}),t.innerHTML=SubscribeIt.Translations.done[this.params.language],this.rightSide.appendChild(t)},t.prototype.adjustHeight=function(){var t,e,n,i,s,a,r;for(i=[this.leftSide,this.middle,this.rightSide],t=function(){var t,e,s;for(s=[],t=0,e=i.length;e>t;t++)n=i[t],s.push(n.clientHeight);return s}(),e=Math.max.apply(null,t),i.push(this.modal),r=[],s=0,a=i.length;a>s;s++)n=i[s],r.push(n.style.height=""+(e+20)+"px");return r},t.prototype.addPodcastInfo=function(){var t,e,n,i,s,a;return this.params.podcastName&&(i=document.createElement("strong"),i.innerHTML=this.params.podcastName,this.leftSide.appendChild(i)),this.params.podcastSubtitle&&(a=document.createElement("div"),a.innerHTML=this.params.podcastSubtitle,this.leftSide.appendChild(a)),this.params.podcastCoverUrl&&(n=document.createElement("img"),n.src=this.params.podcastCoverUrl,this.leftSide.appendChild(n)),e=document.createElement("strong"),e.innerHTML=SubscribeIt.Translations.subscribe[this.params.language],this.leftSide.appendChild(e),t=document.createElement("p"),t.className="subscribe-it-explanation",t.innerHTML=SubscribeIt.Translations.explanation[this.params.language],this.leftSide.appendChild(t),s=document.createElement("a"),s.className="subscribe-it-install-button",s.innerHTML=SubscribeIt.Translations.next[this.params.language],s.addEventListener("click",function(){return this.parentNode.parentNode.className="show-middle"}),this.leftSide.appendChild(s)},t.prototype.extractParams=function(){var t,e,n,i,s,a;for(n=window.location.search.replace(/^\?/,""),e=n.split("&"),this.params={},a=[],i=0,s=e.length;s>i;i++)t=e[i],a.push(this.buildParamObject(t,this.params));return a},t.prototype.buildParamObject=function(t,e){var n;return n=t.split("="),e[n[0]]=decodeURIComponent(n[1])},t.prototype.addCloseHandler=function(){var t;return t=function(){return window.parent.postMessage('{"message": "closepopup"}',"*")},this.closeButton.addEventListener("click",function(){return t()})},t.prototype.addList=function(){var t,e,n,i,s,a,r;for(n=document.getElementById("subscribe-it-list-heading"),n.innerHTML=SubscribeIt.Translations.launchClient[this.params.language],this.addBackButton(this.middle,"show-left"),this.addBackButton(this.rightSide,"show-middle"),i=SubscribeIt.UA.detect(),e=SubscribeIt.Utils.shuffle(SubscribeIt.Clients[i]),r=[],s=0,a=e.length;a>s;s++)t=e[s],r.push(this.addButton(t));return r},t.prototype.addBackButton=function(t,e){var n;return n=document.createElement("a"),n.className="subscribe-it-back-button subscribe-it-install-button",n.innerHTML="&lsaquo;",n.addEventListener("click",function(){return this.parentNode.parentNode.className=e}),t.appendChild(n)},t.prototype.addButton=function(t){var e,n,i,s;return s=document.createElement("span"),i=document.createElement("a"),n=document.createElement("li"),i.href=t.scheme+this.params.feedUrl.replace(/^https?:\/\//,""),i.target="_blank",s.innerHTML=t.title,i.appendChild(s),t.icon&&(e=document.createElement("img"),e.src=""+this.pathPrefix+"images/"+t.icon,i.insertBefore(e,i.firstChild)),n.appendChild(i),this.list.appendChild(n),this.addButtonAction(n,t)},t.prototype.addOtherClientButton=function(){var t,e,n,i;return i=document.createElement("span"),n=document.createElement("a"),e=document.createElement("li"),n.href="#",i.innerHTML=SubscribeIt.Translations.otherClient[this.params.language],n.appendChild(i),t=document.createElement("img"),t.src=""+this.pathPrefix+"images/rss.png",n.insertBefore(t,n.firstChild),e.appendChild(n),this.list.appendChild(e),e.addEventListener("click",function(t){return function(n){var i;return t.helptext.innerHTML="",i=document.createElement("p"),i.innerHTML=SubscribeIt.Translations.otherClientHelp[t.params.language],t.helptext.appendChild(i),t.addLinkField(t.helptext,e),n.currentTarget.parentNode.parentNode.parentNode.className="show-right",t.addDoneButton()}}(this))},t.prototype.addButtonAction=function(t,e){return this.addButtonHover(this.helptext,t,e),this.addButtonClick(this.helptext,t,e)},t.prototype.addButtonHover=function(t,e,n){return e.addEventListener("mouseenter",function(i){return function(){var s,a;if("clicked"!==e.parentNode.className)return t.innerHTML="",s=document.createElement("p"),a=SubscribeIt.Translations.help[i.params.language],a=SubscribeIt.Template.render(a,{clientName:n.title}),s.innerHTML=a,t.appendChild(s)}}(this)),e.addEventListener("mouseleave",function(){return function(){return"clicked"!==e.parentNode.className?t.innerHTML="":void 0}}(this))},t.prototype.addButtonClick=function(t,e,n){return e.addEventListener("click",function(i){return function(s){var a,r,o;return e.parentNode.className="clicked",t.innerHTML="",n.install?(r=document.createElement("p"),o=SubscribeIt.Translations.clicked.install.text[i.params.language],o=SubscribeIt.Template.render(o,{clientName:n.title}),r.innerHTML=""+o,t.appendChild(r),a=document.createElement("a"),a.className="subscribe-it-install-button",a.target="_blank",a.href=n.install,o=SubscribeIt.Translations.clicked.install.button[i.params.language],a.innerHTML=SubscribeIt.Template.render(o,{clientName:n.title}),t.appendChild(a)):(o=SubscribeIt.Translations.clicked.noinstall.text[i.params.language],t.innerHTML=""+o),s.currentTarget.parentNode.parentNode.parentNode.className="show-right",i.addDoneButton()}}(this))},t.prototype.addLinkField=function(t,e){var n,i;return e.parentNode.className="clicked",n=document.createElement("input"),n.value=this.params.feedUrl,n.style.textAlign="center",n.onclick=function(){return this.select()},i=document.createElement("div"),i.className="subscribe-it-link-input",i.appendChild(n),t.appendChild(i)},t}(),SubscribeButton=function(){function t(){var t,e,n;this.extractParams(),e=window.location.search.split("=")[1],n=window.location.search.split("=")[1],t=document.getElementById("subscribe-it-button"),t.className=this.params.size,t.innerHTML="<span>"+SubscribeIt.Translations.button[this.params.language]+"</span>",this.resizeIframe(t)}return t.prototype.extractParams=function(){var t,e,n,i,s,a;for(n=window.location.search.replace(/^\?/,""),e=n.split("&"),this.params={},a=[],i=0,s=e.length;s>i;i++)t=e[i],a.push(this.buildParamObject(t,this.params));return a},t.prototype.buildParamObject=function(t,e){var n;return n=t.split("="),e[n[0]]=n[1]},t.prototype.resizeIframe=function(t){var e,n,i,s,a,r;return a=document.defaultView.getComputedStyle(t),e=parseInt(a.height,10),r=parseInt(a.width,10),n=e+2,i=r,s=IframeResizer.buildData("resizeButton",n,i,this.params.id),window.parent.postMessage(s,"*")},t}(),SubscribeIt.Template={render:function(t,e){var n,i,s,a;return t=t||"",e=e||{},a=/\{([^{}]*)}/g,i=/\{{([^{}]*)}}/g,s=function(t,n){var i;return i=e[n],"string"==typeof i||"number"==typeof i?i:t},n=function(t,n){var i;return i=e[n],"string"==typeof i||"number"==typeof i?i:t},t.replace(i,n)}},SubscribeIt.Utils={shuffle:function(t){var e,n,i;for(e=t.length;--e>0;)n=~~(Math.random()*(e+1)),i=t[n],t[n]=t[e],t[e]=i;return t}},SubscribeIt.UA=function(){return{detect:function(){var t,e,n,i;n=window.navigator&&navigator.userAgent||"",i=SubscribeIt.UAs;for(e in i)if(__hasProp.call(i,e)&&(t=i[e],t.test(n)))return e}}}(),SubscribeIt.UAs={android:/android/i,ios:/(ipad|iphone|ipod)/i,linux:/linux/i,osx:/macintosh/i,windowsPhone:/windows phone/i},SubscribeIt.Translations={button:{de:"Abonnieren",en:"Subscribe"},done:{de:"Fertig",en:"Done"},subscribe:{de:"Podcast Abonnieren",en:"Subscribe to Podcast"},explanation:{de:"Um diesen Podcast zu abonnieren, bitte einen Client in der Mitte auswählen.",en:"Please choose a client from the middle to subscribe to this Podcast."},help:{de:"Podcast abonnieren mit <strong>{{clientName}}</strong>",en:"Subscribe to Podcast with <strong>{{clientName}}</strong>"},launchClient:{de:"Client öffnen",en:"Launch client"},otherClient:{de:"Anderer Client",en:"Other client"},otherClientHelp:{de:"Kopiere die URL und füge sie in deinem Podcast Client hinzu.",en:"Copy URL and add it to your Podcast Client."},next:{de:"Weiter &rsaquo;",en:"Next &rsaquo;"},back:{de:"Zurück",en:"Back"},clicked:{noinstall:{text:{de:"Falls nach dem Klick nichts passiert sein sollte, ist vermutlich kein Client installiert.",en:"If nothing happened after the click you probably have not installed a Client."}},install:{text:{de:"Falls nach dem Klick nichts passiert sein sollte, kannst du <strong>{{clientName}}</strong> hier installieren:",en:"If nothing happened after the click you can install <strong>{{clientName}}</strong> here:"},button:{de:"{{clientName}} Herunterladen",en:"Download {{clientName}}"}}}},SubscribeIt.Clients={android:[{title:"AntennaPod",scheme:"pcast://",platform:["android"],icon:"android/antennapod@2x.png",install:"https://play.google.com/store/apps/details?id=de.danoeh.antennapod"},{title:"BeyondPod",scheme:"pcast://",platform:["android"],icon:"android/beyondpod@2x.png",install:"https://play.google.com/store/apps/details?id=mobi.beyondpod"},{title:"PocketCasts",scheme:"pcast://",platform:["android"],icon:"android/pocketcasts@2x.png",install:"https://play.google.com/store/apps/details?id=au.com.shiftyjelly.pocketcasts"},{title:"Podkicker",scheme:"pcast://",platform:["android"],icon:"android/podkicker@2x.png",install:"https://play.google.com/store/apps/details?id=ait.podka"},{title:"uPod",scheme:"pcast://",platform:["android"],icon:"android/upod@2x.png",install:"https://play.google.com/store/apps/details?id=mobi.upod.app"}],ios:[{title:"Apple Podcasts",scheme:"pcast://",platform:["ios"],icon:"ios/podcasts@2x.png",install:"https://itunes.apple.com/de/app/podcasts/id525463029"},{title:"Castro",scheme:"castro://subscribe/",platform:["ios"],icon:"ios/castro@2x.png",install:"https://itunes.apple.com/de/app/castro-high-fidelity-podcasts/id723142770"},{title:"Downcast",scheme:"downcast://",platform:["ios"],icon:"ios/downcast@2x.png",install:"https://itunes.apple.com/de/app/downcast/id393858566"},{title:"Instacast",scheme:"instacast://",platform:["ios"],icon:"ios/instacast@2x.png",install:"https://itunes.apple.com/de/app/instacast-4-podcast-client/id577056377"},{title:"Overcast",scheme:"overcast://x-callback-url/add?url=",platform:["ios"],icon:"ios/overcast@2x.png",install:"https://itunes.apple.com/de/app/overcast-podcast-player/id888422857"}],osx:[{title:"Downcast",scheme:"downcast://",platform:["osx"],icon:"osx/downcast@2x.png",install:"https://itunes.apple.com/de/app/downcast/id668429425?mt=12&uo=4"},{title:"Instacast",scheme:"instacast://",platform:["osx"],icon:"osx/instacast@2x.png",install:"https://itunes.apple.com/de/app/instacast/id733258666?mt=12&uo=4"},{title:"iTunes",scheme:"itpc://",platform:["osx"],icon:"osx/itunes@2x.png",install:"http://www.apple.com/itunes/"}],windowsPhone:[{title:"Podcasts",scheme:"wp-podcast://",platform:"windowsPhone"}]};